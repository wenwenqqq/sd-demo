
===== Epoch 0 训练前 阶段 GPU 显存信息 (rank=0) =====
GPU 0 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.71 GiB
  预留缓存显存: 0.78 GiB
  可用显存: 10.04 GiB
  峰值已分配显存: 0.71 GiB
GPU 1 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 2 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 3 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 4 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 5 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 6 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 7 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
Rank 0 Epoch 1/2: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:12<00:00,  2.25it/s, loss=1.18]

===== Epoch 0 训练后 阶段 GPU 显存信息 (rank=0) =====
GPU 0 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 1.60 GiB
  预留缓存显存: 8.31 GiB
  可用显存: 9.15 GiB
  峰值已分配显存: 7.55 GiB
GPU 1 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 2 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 3 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 4 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 5 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 6 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 7 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB

===== Epoch 0 验证前 阶段 GPU 显存信息 (rank=0) =====
GPU 0 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 1.60 GiB
  预留缓存显存: 8.31 GiB
  可用显存: 9.15 GiB
  峰值已分配显存: 1.60 GiB
GPU 1 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 2 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 3 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 4 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 5 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 6 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
GPU 7 (NVIDIA GeForce RTX 2080 Ti):
  总显存: 10.75 GiB
  已分配显存: 0.00 GiB
  预留缓存显存: 0.00 GiB
  可用显存: 10.75 GiB
  峰值已分配显存: 0.00 GiB
  File "/data/bdd100k/sd/DiT_from_scratch/stable_diffusion_from_scratch/train_stable_diffusion_DDP_multithead.py", line 344, in <module>
  File "/data/bdd100k/sd/DiT_from_scratch/stable_diffusion_from_scratch/train_stable_diffusion_DDP_multithead.py", line 275, in main
    # latents = model.module.encode(data)
KeyError: 'images'
